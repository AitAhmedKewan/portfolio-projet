<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Scripts PowerShell ‚Äì Portfolio BTS SIO</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: #f5f7fa;
      color: #333;
      line-height: 1.6;
      padding: 0;
    }

    header {
      background-color: #1e293b;
      color: white;
      padding: 2rem 1rem;
      text-align: center;
    }

    header h1 {
      margin: 0;
      font-size: 2rem;
    }

    .container {
      max-width: 960px;
      margin: auto;
      padding: 2rem 1rem;
    }

    section {
      margin-bottom: 2rem;
      background-color: white;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    h2 {
      color: #1e40af;
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
    }

    pre {
      background-color: #2d2d2d;
      color: #f8f8f8;
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    code {
      color: #d4d4d4;
    }

    footer {
      text-align: center;
      padding: 2rem 1rem;
      color: white;
      background-color: #1e293b;
    }

    .link {
      text-decoration: none;
      color: #1e40af;
    }

    .btn {
      background-color: #1e40af;
      color: white;
      padding: 0.6rem 1rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }

    .btn:hover {
      background-color: #0f2a60;
    }

  </style>
</head>
<body>

<header>
  <h1>Scripts PowerShell ‚Äì Projet Active Directory</h1>
  <p>Pr√©sentation des scripts PowerShell utilis√©s pour l'administration et la gestion des utilisateurs dans l'infrastructure Active Directory.</p>
</header>

<div class="container">
  
  <section>
    <h2>1. Script de cr√©ation d'un utilisateur</h2>
    <p>
      Ce script permet de cr√©er un nouvel utilisateur dans Active Directory avec des attributs personnalis√©s comme le pr√©nom, le nom et le nom d'utilisateur. Il d√©finit √©galement un mot de passe initial et un r√©pertoire pour chaque utilisateur avec des autorisations sp√©cifiques.
    </p>
    <pre><code>
param (
    [string]$Prenom,
    [string]$Nom
)

$DomainName="dom.kewan"
$DomName="DOMKEWAN"
$SamAccountName = "$($Prenom.Substring(0,1))$Nom".ToLower()
$Nom = $Nom.ToUpper()
$Prenom = "$($Prenom.Substring(0,1))".ToUpper() + "$($Prenom.Substring(1))".ToLower()

New-ADUser `
    -Name "$Prenom $Nom" `
    -GivenName "$Prenom" `
    -Surname "$Nom" `
    -SamAccountName "$SamAccountName" `
    -UserPrincipalName "$SamAccountName@$DomainName" `
    -Path "OU=Utilisateurs,DC=dom,DC=kewan" `
    -AccountPassword (ConvertTo-SecureString "Eleve1234!" -AsPlainText -Force) `
    -Enabled $true `
    -ChangePasswordAtLogon $true

$RepUser = "C:\Partages\$SamAccountName"
New-Item -Path $RepUser -ItemType Directory
$acl = Get-Acl $RepUser
$acl.SetAccessRuleProtection($true,$false)
$droitsUser = New-Object System.Security.AccessControl.FileSystemAccessRule($User,"Modify","ContainerInherit,ObjectInherit","None","Allow")
$acl.AddAccessRule($droitsUser)
Set-Acl -Path $RepUser -AclObject $acl
    </code></pre>
    <p>Ce script cr√©e un utilisateur Active Directory et attribue un r√©pertoire de stockage personnel avec des permissions appropri√©es.</p>
  </section>

  <section>
    <h2>2. Script de login</h2>
    <p>
      Ce script est ex√©cut√© lors de l'ouverture de session d'un utilisateur. Il enregistre les connexions dans un fichier CSV avec la date, l'heure, le nom d'utilisateur et le nom de la machine.
    </p>
    <pre><code>
Add-content -Path "\\192.168.2.1\Logs$\connect.cvs" -Value "C;$(Get-Date -Format yyyy-MM-dd-hh:mm:ss);$Env:USERNAME;$Env:COMPUTERNAME"
    </code></pre>
    <p>Ce script permet de suivre les connexions des utilisateurs en temps r√©el dans un fichier centralis√©.</p>
  </section>

  <section>
    <h2>3. Script de logout</h2>
    <p>
      Ce script est ex√©cut√© lors de la fermeture de session d'un utilisateur. Il enregistre les d√©connexions dans le m√™me fichier CSV.
    </p>
    <pre><code>
Add-content -Path "\\192.168.2.1\Logs$\connect.cvs" -Value "D;$(Get-Date -Format yyyy-MM-dd-hh:mm:ss);$Env:USERNAME;$Env:COMPUTERNAME"
    </code></pre>
    <p>Ce script permet d'enregistrer les d√©connexions pour un suivi complet des utilisateurs connect√©s.</p>
  </section>

  <section>
    <h2>4. Script de sauvegarde</h2>
    <p>
      Ce script permet de sauvegarder des fichiers importants sur un serveur de sauvegarde. Il v√©rifie si la sauvegarde est r√©ussie et affiche un message d'erreur si quelque chose ne va pas.
    </p>
    <pre><code>
$dossierASauvegarder = "C:\Sauvegardes\"
$destination = "\Sauvegardes_clients"

try {
    Copy-Item -Path $dossierASauvegarder -Destination "$destination\$env:COMPUTERNAME" -Recurse
    Write-Host "Les fichiers ont √©t√© sauvegard√©s"
}
catch {
     Write-Host "Erreur dans la sauvegarde : $_"
}
    </code></pre>
    <p>Ce script garantit la s√©curit√© des donn√©es des utilisateurs en les sauvegardant r√©guli√®rement dans un emplacement d√©di√©.</p>
  </section>

  <section>
    <h2>5. Script de cr√©ation d‚Äôun utilisateur simplifi√©</h2>
    <p>
      Ce script cr√©e un utilisateur et lui attribue un r√©pertoire avec des permissions. Il permet d'automatiser le processus de cr√©ation d'utilisateurs pour de grands environnements.
    </p>
    <pre><code>
New-ADUser -Name "eleve" -AccountPassword (ConvertTo-SecureString "eleve" -AsPlainText -Force) -Enabled $true
New-Item -Path "C:\Users\eleve" -ItemType Directory
New-SmbShare -Name "eleve" -Path "C:\Users\eleve" -FullAccess "eleve"
$acl = Get-Acl "C:\Users\eleve"
$acl.SetAccessRule((New-Object System.Security.AccessControl.FileSystemAccessRule("eleve", "FullControl", "ContainerInherit,ObjectInherit", "None", "Allow")))
Set-Acl -Path "C:\Users\eleve" -AclObject $acl
    </code></pre>
    <p>Un script d'usage quotidien pour cr√©er des utilisateurs avec un r√©pertoire personnel partag√© et des permissions d'acc√®s.</p>
  </section>

  <section>
    <h2>üí° Conclusion</h2>
    <p>
      Ces scripts PowerShell sont des outils essentiels pour administrer Active Directory, cr√©er des utilisateurs, g√©rer les connexions et assurer la sauvegarde des donn√©es. Ils permettent d'automatiser de nombreuses t√¢ches r√©p√©titives et d'am√©liorer l'efficacit√© dans un environnement d'entreprise.
    </p>
  </section>

</div>

<div style="text-align: right; max-width: 960px; margin: auto; padding: 1rem;">
    <a href="activedirectory.html" style="
      display: inline-block;
      padding: 0.6rem 1rem;
      background-color: #1e40af;
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      transition: background-color 0.3s ease;
    ">‚¨ÖÔ∏è Retour</a>
  </div>

  <footer class="w3l-footer-29-main">
    <div class="footer-29 pt-1 pb-4">
      <p class="copy-footer-29 text-center pt-lg-2 mt-5 pb-2">¬© Ait-Ahmed K√©wan - Portfolio BTS&nbsp;SIO&nbsp;Chantilly</p>
    </div>
  </footer>

</body>
</html>
